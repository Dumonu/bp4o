#!/usr/bin/env bash
set -eo pipefail

OFF=$'\033[0;0m'
BOLD=$'\033[0;1m'
BLACK=$'\033[0;30m'
RED=$'\033[0;31m'
GREEN=$'\033[0;32m'
YELLOW=$'\033[0;33m'
BLUE=$'\033[0;34m'
MAGENTA=$'\033[0;35m'
CYAN=$'\033[0;36m'
WHITE=$'\033[0;37m'

[ -z "$LESS" ] && LESS=-FRX

if [ -t 1 ]; then
    $@ | sed -r -e "s/(^\.\.\. #[0-9]+ change [0-9]+ .+)/$YELLOW\1$OFF/g" \
                -e "s/(^\.\.\. \.\.\. .+)/$MAGENTA\1$OFF/g" \
                -e "s!(^//.+)!$BOLD\1$OFF!g" | less
else
    $@ | less
fi

exit $?
